# 时间序列

## 1. EGADS

参考雅虎EGADS，实现用于大规模时间序列数据自动化异常检测的通用和可扩展框架


各种用例中可以提高50-60%的精确度和召回率 ？？

将预测、异常检测和告警分为三个独立组件，允许用户在任何组件中添加自己的模型。需要注意的是，本文重点讨论后两个组件。    

但当时间序列的特征发生变化时，这些技术在没有适当重新训练的情况下表现不佳。第6.3节展示了“一刀切”原则在实践中的不足

![egads架构.png](egads架构.png)

时间序列建模模块（TMM）、异常检测模块（ADM）和告警模块（AM）。给定一个时间序列，TMM组件对时间序列进行建模，生成ADM和AM组件使用的预期值，分别计算误差和过滤不感兴趣的异常。

批量流程包括三个步骤：
- 监控的时间序列数据批量存储在Hadoop集群上。
- 批量模型生成器在这些数据上运行并为针对的时间序列构建模型。
- 模型存储在模型数据库中。

在线流程随后利用存储的模型, 数据流入Storm流处理拓扑
- 拓扑中的一个模块（bolt）调用EGADS ADM，根据模型数据库中存储的模型评估传入数据点。
- 如果检测到异常，这将被馈送到二级规则流程，包括组合规则和其他特定用例的逻辑（见第4节）。
- 根据规则，如果异常是告警事件，事件将被生成，存储在状态数据库中，并转发到告警路由系统。
- 告警路由系统应用路由配置规则，将告警发送给适当的支援人员。

异常检测算法能够检测以下三类异常：
1. 离群点(Outliers)：给定输入时间序列x，离群点是时间戳-值对$⟨t, xt⟩$，其中观测值xt与该时间的预期值$E(xt)$显著不同。
2. 变化点(Change points)：给定输入时间序列x，变化点是时间戳$t$，使得时间序列在$t$之前和之后的行为显著不同。
3. 异常时间序列(Anomalous time-series)：给定一组时间序列$X = \{x^i\}$，异常时间序列$x^j ∈ X$是其行为与X中的大多数时间序列显著不同的时间序列。


时间序列趋势线很明显，学会看图作数据的分析; 评估预测效果，才能优化和迭代

时间序列不能做**交叉验证**，得使用back test, 在量化中称为回测，原因防止出现data leak

back test

![back_test.png](back_test.png)


data leak: 你的模型在无意间已经拿到了验证集的信息, 交叉验证

### 时间序列的评估